# CVE Service Layer API
This is an application developed using the Spring Boot Web MVC starter project that exposes multiple URL endpoints for retrieving Common Vulnerabilities and Exposures (CVEs).  These vulnerabilities were obtained from the [National Vulnerability Database's](https://nvd.nist.gov/vuln/data-feeds) data feeds.  These data feeds were downloaded and subsequently scrubbed using Elasticsearch and additionally cleaned up by this web service.  This web service uses that scrubbed JSON file as it's datasource.  There is not a separate persistence layer or standalone DBMS.

## Quick Start
### Viewing the Live Demo
The application is currently deployed to [Heroku Cloud](https://www.heroku.com) at the following URL: https://cve-dashboard-service.herokuapp.com/api/cves/

### Running Application Locally
This project was built using the Spring Boot Web Starter project.  The following are prerequisites before running this application locally:
* Java 8 or greater
* Maven

Once you clone this project locally you can run the following command in the root directory of this project:
### `mvn spring-boot:run` 

Verify there are no errors printed to the console then access the REST service at the following URL: http://localhost:8080/api/cves?maxSize=5

#### Running the unit tests
* You can run the unit tests by running `mvn test`
* Unit tests are classes in the src/test/java folder that have a Test suffix.

#### Running the integration tests
* You can run the integration tests by running `mvn verify` or `mvn integration-test`
* Integration tests are classes in the src/test/java folder that have an IT suffix.


## Why was this application built?
### Reason #1 - Demonstrate Integration of a React web application with Spring Boot REST API
The reason for building this application is to demonstrate how to build a [React web application](https://github.com/michaelyebba/cve-dashboard-web/) that integrates with this Service Layer developed using Spring Boot Web MVC. Please see the web project's README.md file for additional documentation on how to set up the React web application.

### Reason #2 - Demonstrate CI/CD Integration with TravisCI
Additionally, this application demonstrates how to integrate with TravisCI to report on any build failures as well as deploy continuously to GitHub pages.  Click here to [View this project's CI/CD Pipeline](https://travis-ci.com/michaelyebba/cve-dashboard-service/).  For more information, view [.travis.yml](https://github.com/michaelyebba/cve-dashboard-service/blob/master/.travis.yml) in the root directory of this project.

## What does this application do?
The following are the current endpoints published by the service layer.  By default, the results are sorted by date DESC (so the most recent are displayed first) and only 10 records are displayed at a time.  The service layer reads the scrubbed JSON CVE file as the datastore.

### Display list of the most recent CVEs
`https://cve-dashboard-service.herokuapp.com/api/cves`

By default, the service only returns a maximum of 10 records.  You can override that using the `maxSize` request parameter:
`https://cve-dashboard-service.herokuapp.com/api/cves?maxSize=2000`

### Display list of most recent CVEs by severity
`https://cve-dashboard-service.herokuapp.com/api/cves?severity=HIGH&maxSize=2000`

### Display list of most recent CVEs by product name
`https://cve-dashboard-service.herokuapp.com/api/cves?product=google&maxSize=2000`

### Display list of unique severities
`https://cve-dashboard-service.herokuapp.com/api/severities`

### Return an individual CVE Record by ID
`https://cve-dashboard-service.herokuapp.com/api/cves/CVE-2019-1003044`

Future enhancements include:
* Implement pagination of large result sets.
* Provide flat file export capability.
* Fully integrate with Elasticsearch instead of using a standalone scrubbed data file.

### CVE Data Format

<pre>
{
    "id": "CVE-2019-1003044",
    "year": 2019,
    "severity": "HIGH",
    "category": "NETWORK",
    "products": [
        "jenkins slack_notification 2.19  ~~~jenkins~~"
    ],
    "description": "A cross-site request forgery vulnerability in Jenkins Slack Notification Plugin 2.19 and earlier allows attackers to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.",
    "dateTime": "2019-04-02T10:21:02.063-04:00",
    "formattedDate": "2019-04-02T15:03:02.000+0000",
    "productSummary": "jenkins slack_notification 2.19  ~~~jenkins~~"
}  
</pre>

#### How was the source data loaded?
This service has gone through great lengths to scrub the data downloaded from the National Vulnerability Database.
* Step 1 - Ran the quick start in https://github.com/joshbressers/cve-analysis to load the raw XML NVD data into a local instance of Elasticsearch.
* Step 2 - Exported all the CVE data from Elasticsearch into JSON format and saved as a classpath resource
* Step 3 - ran [Json2pojo](http://www.jsonschema2pojo.org/) utility to generate GSON POJOs for consuming JSON files in Java.
* Step 4 - Create a CVE POJO that returns the above data in JSON format.

## Additional Notes
To run this locally with the [cve-dashboard-web application](https://github.com/michaelyebba/cve-dashboard-web/) you must change the API URL in Dashboard.js to point to localhost:8080 instead of heroku.
