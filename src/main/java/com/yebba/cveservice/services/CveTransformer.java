/**
 * 
 */
package com.yebba.cveservice.services;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import com.yebba.cveservice.model.Cve;
import com.yebba.cveservice.pojo.high.Hit;
import com.yebba.cveservice.pojo.high.Source;

/**
 * Transforms an elasticsearch Hit object to a service layer Cve object
 * 
 * @author myebba
 *
 */
public class CveTransformer {

	private static final Log log = LogFactory.getLog(CveTransformer.class);

	/**
	 * Transforms a Hit object to a cve object
	 * 
	 * @param hit
	 * @return
	 */
	public static Cve transform(Hit hit) {
		Cve cve = null;
		if (hit != null && hit.getSource() != null) {
			
			log.debug("transforming hit " + hit.getId() + " to Cve object");
			Source source = hit.getSource();
		
			cve = new Cve();
			cve.setId(hit.getId());
			
			// set source fields
			cve.setCategory(source.getCvssAccessVector());
			cve.setDateTime(source.getCvssGeneratedOnDatetime());
			cve.setDescription(source.getDescription());
			cve.setProducts(source.getProduct());
			cve.setSeverity(source.getCvssAccessComplexity());
			cve.setYear(source.getYear());
					
		} else {
			log.warn("hit '" + (hit!=null?hit.getId():hit) + "' has null source; transformation will be skipped.");
		}
	
		return cve;
	}
}
