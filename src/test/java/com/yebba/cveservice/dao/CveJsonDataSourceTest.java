package com.yebba.cveservice.dao;

import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import org.junit.Before;
import org.junit.Test;

import com.google.gson.stream.JsonReader;
import com.yebba.cveservice.pojo.high.CveDef;

/**
 * Integration test for CveJsonDataSource
 * 
 * @author myebba
 *
 */
public class CveJsonDataSourceTest {
	
	private CveJsonDataSource ds;
	
	@Before
	public void setUp() {
		ds = new CveJsonDataSource();
	}

	@Test
	public void testGetCveJsonReader_fileExists() {
		try {
			JsonReader cveJsonReader = ds.getCveJsonReader();
			assertNotNull(cveJsonReader);			
		} catch (Exception e) {
			e.printStackTrace();
			fail(e.getMessage());
		}
	}
	
	@Test
	public void testFetchAll_hitCountGreaterThan1000() {
		try {
			CveDef cve = ds.fetchAll();
			assertNotNull(cve);
			assertNotNull(cve.getHits());
			assertNotNull(cve.getHits().getHits());
			assertTrue(cve.getHits().getHits().size() > 1000);
		} catch (Exception e) {
			e.printStackTrace();
			fail(e.getMessage());						
		}
	}
}