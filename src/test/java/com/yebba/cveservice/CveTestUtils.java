/**
 * 
 */
package com.yebba.cveservice;

import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

import com.yebba.cveservice.model.Cve;
import com.yebba.cveservice.pojo.high.CveDef;
import com.yebba.cveservice.pojo.high.Hit;
import com.yebba.cveservice.pojo.high.Hits;
import com.yebba.cveservice.pojo.high.Source;
import com.yebba.cveservice.services.CveTransformer;

/**
 * Utility class that contains test data objects for unit testing
 * 
 * @author myebba
 *
 */
public class CveTestUtils {
	
	/**
	 * Returns a cve object for testing
	 * @return
	 */
	public static Cve getCve() {
		return CveTransformer.transform(getHitSourceNotNull());
	}
	
	/**
	 * Returns a list of cves for testing
	 * @return
	 */
	public static List<Cve> getCves() {
		List<Cve> cves = new ArrayList<Cve>();
		cves = getTestData().getHits().getHits().stream()
		.map(CveTransformer::transform)
		.collect(Collectors.toList());
		return cves;
	}
	
	/**
	 * Returns a hit with a not null source
	 * @return
	 */
	public static Hit getHitSourceNotNull() {
		Hit hit1 = new Hit();
		hit1.setId("CVE-2019-0591");
		Source source1 = new Source();
		source1.setCvssAccessComplexity("HIGH");
		source1.setCvssAccessVector("NETWORK");
		source1.setYear(2019);
		source1.setCvssConfidentialityImpact("COMPLETE");
		
		List<String> products1 = new ArrayList<String>();
		products1.add("microsoft");
		source1.setProduct(products1);
		hit1.setSource(source1);
		return hit1;
	}
	
	/**
	 * returns a Hit with a null source
	 * @return
	 */
	public static Hit getHitSourceNull() {
		Hit hit7 = new Hit();
		hit7.setId("Nosource");
		return hit7;
	}

	/**
	 * Returns test data  whitebox unit testing
	 * 
	 * @return
	 */
	public static CveDef getTestData() {
		CveDef all = new CveDef();
		Hits hits = new Hits();
		List<Hit> hitList = new ArrayList<Hit>();
		hits.setHits(hitList);
		
		// create 7 hits for testing
		Hit hit1 = new Hit();
		hit1.setId("CVE-2019-0591");
		Source source1 = new Source();
		source1.setCvssAccessComplexity("HIGH");
		source1.setCvssAccessVector("NETWORK");
		source1.setYear(2019);
		source1.setCvssConfidentialityImpact("COMPLETE");
		source1.setCvssGeneratedOnDatetime("2019-01-06T13:01:41.270-05:00");
		
		List<String> products1 = new ArrayList<String>();
		products1.add("microsoft");
		source1.setProduct(products1);
		hit1.setSource(source1);
		hits.getHits().add(hit1);
		
		// hit 2
		Hit hit2 = new Hit();
		hit2.setId("CVE-2019-2438");
		Source source2 = new Source();
		source2.setCvssAccessComplexity("MEDIUM");
		source2.setCvssAccessVector("NETWORK");
		source2.setYear(2019);
		source2.setCvssConfidentialityImpact("COMPLETE");
		source2.setCvssGeneratedOnDatetime("2019-02-06T13:01:41.270-05:00");
		
		List<String> products2 = new ArrayList<String>();
		products2.add("oracle");
		source2.setProduct(products2);
		hit2.setSource(source2);
		hits.getHits().add(hit2);
		
		// hit 3
		Hit hit3 = new Hit();
		hit3.setId("CVE-2019-0607");
		Source source3 = new Source();
		source3.setCvssAccessComplexity("LOW");
		source3.setCvssAccessVector("NETWORK");
		source3.setYear(2019);
		source3.setCvssConfidentialityImpact("COMPLETE");
		source3.setCvssGeneratedOnDatetime("2019-03-06T13:01:41.270-05:00");

		
		List<String> products3 = new ArrayList<String>();
		products3.add("google");
		source3.setProduct(products3);
		hit3.setSource(source3);
		hits.getHits().add(hit3);
		
		// hit 4
		Hit hit4 = new Hit();
		hit4.setId("CVE-2019-6110");
		Source source4 = new Source();
		source4.setCvssAccessComplexity("HIGH");
		source4.setCvssAccessVector("NETWORK");
		source4.setYear(2019);
		source4.setCvssConfidentialityImpact("COMPLETE");
		source4.setCvssGeneratedOnDatetime("2019-04-06T13:01:41.270-05:00");

		
		List<String> products4 = new ArrayList<String>();
		products4.add("openbsd");
		source4.setProduct(products4);
		hit4.setSource(source4);
		hits.getHits().add(hit4);
		
		// hit 5
		Hit hit5 = new Hit();
		hit5.setId("CVE-2019-0567");
		Source source5 = new Source();
		source5.setCvssAccessComplexity("MEDIUM");
		source5.setCvssAccessVector("NETWORK");
		source5.setYear(2019);
		source5.setCvssConfidentialityImpact("COMPLETE");
		source5.setCvssGeneratedOnDatetime("2019-05-06T13:01:41.270-05:00");

		
		List<String> products5 = new ArrayList<String>();
		products5.add("microsoft");
		source5.setProduct(products5);
		hit5.setSource(source5);
		hits.getHits().add(hit5);
		
		// hit 6
		Hit hit6 = new Hit();
		hit6.setId("CVE-2019-0634");
		Source source6 = new Source();
		source6.setCvssAccessComplexity("LOW");
		source6.setCvssAccessVector("NETWORK");
		source6.setYear(2019);
		source6.setCvssConfidentialityImpact("COMPLETE");
		source6.setCvssGeneratedOnDatetime("2019-06-06T13:01:41.270-05:00");

		List<String> products6 = new ArrayList<String>();
		products6.add("google");
		source6.setProduct(products6);
		hit6.setSource(source6);
		hits.getHits().add(hit6);
		
		// hit 7
		Hit hit7 = new Hit();
		hit7.setId("Nosource");
		hits.getHits().add(hit7);
		
		// add all hits
		all.setHits(hits);
		return all;
	}
}