/**
 * 
 */
package com.yebba.cveservice.services;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertNull;
import static org.junit.Assert.assertTrue;

import java.util.List;

import org.junit.Test;

import com.yebba.cveservice.CveTestUtils;
import com.yebba.cveservice.model.Cve;
import com.yebba.cveservice.pojo.high.Hit;
import com.yebba.cveservice.pojo.high.Source;

/**
 * Unit test for CveTransformer
 * 
 * @author myebba
 *
 */
public class CveTransformerTest {
	
	@Test
	public void testTransform_HitSourceIsNotNull() {
		Hit hit = CveTestUtils.getHitSourceNotNull();
		assertNotNull(hit);
		
		Cve cve = CveTransformer.transform(hit);
		assertNotNull(cve);
		
		Source source = hit.getSource();
		assertNotNull(source);
		assertEquals(hit.getId(), cve.getId());
		assertEquals(source.getCvssAccessVector(), cve.getCategory());
		assertEquals(source.getCvssAccessComplexity(), cve.getSeverity());
		assertEquals(source.getDescription(), cve.getDescription());
		assertEquals(source.getCvssGeneratedOnDatetime(), cve.getDateTime());
		assertEquals(source.getYear(), cve.getYear());
		
		List<String> products = source.getProduct();
		assertNotNull(products);
		assertTrue(products.size() > 0);
		assertNotNull(cve.getProducts());
		assertEquals(products.size(), cve.getProducts().size());
	}
	
	@Test
	public void testTransform_HitSourceIsNull() {
		Hit hit = CveTestUtils.getHitSourceNull();
		assertNotNull(hit);
		assertNull(hit.getSource());
		Cve cve = CveTransformer.transform(hit);
		assertNull(cve);
	}
	
	@Test
	public void testTransform_HitIsNull() {
		Cve cve = CveTransformer.transform(null);
		assertNull(cve);
	}
}
